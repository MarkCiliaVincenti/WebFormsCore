!function(){"use strict";var e,t=11;function n(e,n){var r,i,a,o,u=n.attributes;if(n.nodeType!==t&&e.nodeType!==t){for(var s=u.length-1;s>=0;s--)i=(r=u[s]).name,a=r.namespaceURI,o=r.value,a?(i=r.localName||i,e.getAttributeNS(a,i)!==o&&("xmlns"===r.prefix&&(i=r.name),e.setAttributeNS(a,i,o))):e.getAttribute(i)!==o&&e.setAttribute(i,o);for(var c=e.attributes,d=c.length-1;d>=0;d--)i=(r=c[d]).name,(a=r.namespaceURI)?(i=r.localName||i,n.hasAttributeNS(a,i)||e.removeAttributeNS(a,i)):n.hasAttribute(i)||e.removeAttribute(i)}}var r="http://www.w3.org/1999/xhtml",i="undefined"==typeof document?void 0:document,a=!!i&&"content"in i.createElement("template"),o=!!i&&i.createRange&&"createContextualFragment"in i.createRange();function u(t){return t=t.trim(),a?function(e){var t=i.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(t):o?function(t){return e||(e=i.createRange()).selectNode(i.body),e.createContextualFragment(t).childNodes[0]}(t):function(e){var t=i.createElement("body");return t.innerHTML=e,t.childNodes[0]}(t)}function s(e,t){var n,r,i=e.nodeName,a=t.nodeName;return i===a||(n=i.charCodeAt(0),r=a.charCodeAt(0),n<=90&&r>=97?i===a.toUpperCase():r<=90&&n>=97&&a===i.toUpperCase())}function c(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var d={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}c(e,t,"selected")},INPUT:function(e,t){c(e,t,"checked"),c(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var i=r.nodeValue;if(i==n||!n&&i==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,i=-1,a=0,o=e.firstChild;o;)if("OPTGROUP"===(r=o.nodeName&&o.nodeName.toUpperCase()))o=(n=o).firstChild;else{if("OPTION"===r){if(o.hasAttribute("selected")){i=a;break}a++}!(o=o.nextSibling)&&n&&(o=n.nextSibling,n=null)}e.selectedIndex=i}}},l=1,f=11,h=3,m=8;function v(){}function p(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const g=new Error("request for lock canceled");var w=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{s(r.next(e))}catch(e){a(e)}}function u(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}s((r=r.apply(e,t||[])).next())}))};class b{constructor(e,t=g){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()}))}runExclusive(e,t=1){return w(this,void 0,void 0,(function*(){const[n,r]=yield this.acquire(t);try{return yield e(n)}finally{r()}}))}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()}))}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach((e=>e.forEach((e=>e.reject(this._cancelError))))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const r=this._value,i=t;this._value-=t,t=this._value+1,n.resolve([r,this._newReleaser(i)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((e=>e())),this._weightedWaiters[e-1]=[])}}var E=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{s(r.next(e))}catch(e){a(e)}}function u(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}s((r=r.apply(e,t||[])).next())}))};const y=function(e){return function(t,n,a){if(a||(a={}),"string"==typeof n)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var o=n;(n=i.createElement("html")).innerHTML=o}else n=u(n);else n.nodeType===f&&(n=n.firstElementChild);var c=a.getNodeKey||p,g=a.onBeforeNodeAdded||v,w=a.onNodeAdded||v,b=a.onBeforeElUpdated||v,E=a.onElUpdated||v,y=a.onBeforeNodeDiscarded||v,N=a.onNodeDiscarded||v,A=a.onBeforeElChildrenUpdated||v,T=a.skipFromChildren||v,_=a.addChild||function(e,t){return e.appendChild(t)},C=!0===a.childrenOnly,S=Object.create(null),x=[];function k(e){x.push(e)}function U(e,t){if(e.nodeType===l)for(var n=e.firstChild;n;){var r=void 0;t&&(r=c(n))?k(r):(N(n),n.firstChild&&U(n,t)),n=n.nextSibling}}function L(e,t,n){!1!==y(e)&&(t&&t.removeChild(e),N(e),U(e,n))}function P(e){w(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=c(t);if(r){var i=S[r];i&&s(t,i)?(t.parentNode.replaceChild(i,t),R(i,t)):P(t)}else P(t);t=n}}function R(t,n,r){var a=c(n);if(a&&delete S[a],!r){if(!1===b(t,n))return;if(e(t,n),E(t),!1===A(t,n))return}"TEXTAREA"!==t.nodeName?function(e,t){var n,r,a,o,u,f=T(e),v=t.firstChild,p=e.firstChild;e:for(;v;){for(o=v.nextSibling,n=c(v);!f&&p;){if(a=p.nextSibling,v.isSameNode&&v.isSameNode(p)){v=o,p=a;continue e}r=c(p);var w=p.nodeType,b=void 0;if(w===v.nodeType&&(w===l?(n?n!==r&&((u=S[n])?a===u?b=!1:(e.insertBefore(u,p),r?k(r):L(p,e,!0),p=u):b=!1):r&&(b=!1),(b=!1!==b&&s(p,v))&&R(p,v)):w!==h&&w!=m||(b=!0,p.nodeValue!==v.nodeValue&&(p.nodeValue=v.nodeValue))),b){v=o,p=a;continue e}r?k(r):L(p,e,!0),p=a}if(n&&(u=S[n])&&s(u,v))f||_(e,u),R(u,v);else{var E=g(v);!1!==E&&(E&&(v=E),v.actualize&&(v=v.actualize(e.ownerDocument||i)),_(e,v),P(v))}v=o,p=a}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=c(t))?k(n):L(t,e,!0),t=r}}(e,p,r);var y=d[e.nodeName];y&&y(e,t)}(t,n):d.TEXTAREA(t,n)}!function e(t){if(t.nodeType===l||t.nodeType===f)for(var n=t.firstChild;n;){var r=c(n);r&&(S[r]=n),e(n),n=n.nextSibling}}(t);var D,O,F=t,I=F.nodeType,V=n.nodeType;if(!C)if(I===l)V===l?s(t,n)||(N(t),F=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(t,(D=n.nodeName,(O=n.namespaceURI)&&O!==r?i.createElementNS(O,D):i.createElement(D)))):F=n;else if(I===h||I===m){if(V===I)return F.nodeValue!==n.nodeValue&&(F.nodeValue=n.nodeValue),F;F=n}if(F===n)N(t);else{if(n.isSameNode&&n.isSameNode(F))return;if(R(F,n,C),x)for(var q=0,B=x.length;q<B;q++){var M=S[x[q]];M&&L(M,M.parentNode,!1)}}return!C&&F!==t&&t.parentNode&&(F.actualize&&(F=F.actualize(t.ownerDocument||i)),t.parentNode.replaceChild(F,t)),F}}(n),N=new class{constructor(e){this._semaphore=new b(1,e)}acquire(){return E(this,void 0,void 0,(function*(){const[,e]=yield this._semaphore.acquire();return e}))}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}};function A(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}function T(e){const t=document.body.querySelectorAll('input[type="file"]');for(let e=0;e<t.length;e++){if(t[e].files.length>0)return!0}return!1}function _(e){return e.closest("[data-wfc-form]")}function C(e,t,n){const r=t.querySelectorAll("input, select, textarea");console.log(n,t,r);for(let t=0;t<r.length;t++){const i=r[t];i.hasAttribute("data-wfc-ignore")||"button"===i.type||"submit"===i.type||"reset"===i.type||(!n&&_(i)||("checkbox"===i.type||"radio"===i.type?i.checked&&e.append(i.name,i.value):e.append(i.name,i.value)))}}async function S(e,t,r){const i=await N.acquire();try{const i=document.getElementById("pagestate"),a=location.pathname+location.search;let o;e?"FORM"===e.tagName?o=new FormData(e):(o=new FormData,C(o,e,!0)):o=new FormData;let u=!!e&&T();i&&(u||(u=T(document.body)),C(o,document.body,!1)),t&&o.append("wfcTarget",t),r&&o.append("wfcArgument",r),document.dispatchEvent(new CustomEvent("wfc:beforeSubmit",{detail:{form:e,eventTarget:t,formData:o}}));const s={method:"POST"};s.body=u?o:new URLSearchParams(o);const c=await fetch(a,s);if(!c.ok)throw document.dispatchEvent(new CustomEvent("wfc:submitError",{detail:{form:e,eventTarget:t,response:c}})),new Error(c.statusText);const d=await c.text(),l=[],f={onNodeAdded(n){l.push(n),document.dispatchEvent(new CustomEvent("wfc:addNode",{detail:{node:n,form:e,eventTarget:t}}))},onBeforeElUpdated:function(e,t){if("INPUT"===e.tagName&&"hidden"!==e.type)return n(e,t),A(e,t,"checked"),A(e,t,"disabled"),t.hasAttribute("value")&&(e.value=t.value),!1},onBeforeNodeDiscarded(n){var r,i;if("SCRIPT"===n.tagName)return!1;if("FORM"===n.tagName&&n.hasAttribute("data-wfc-form"))return!1;if("DIV"===n.tagName&&n.hasAttribute("data-wfc-owner")&&(null!==(r=n.getAttribute("data-wfc-owner"))&&void 0!==r?r:"")!==(null!==(i=null==e?void 0:e.id)&&void 0!==i?i:""))return!1;return!!document.dispatchEvent(new CustomEvent("wfc:discardNode",{detail:{node:n,form:e,eventTarget:t},cancelable:!0}))&&void 0}},h=(new DOMParser).parseFromString(d,"text/html");y(document.head,h.querySelector("head"),f),y(document.body,h.querySelector("body"),f),document.dispatchEvent(new CustomEvent("wfc:afterSubmit",{detail:{form:e,eventTarget:t,newElements:l}}))}finally{i()}}const x=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=async function(){this.hasAttribute("data-wfc-form")?await S(this):x.call(this)},document.addEventListener("submit",(async function(e){e.target instanceof Element&&e.target.hasAttribute("data-wfc-form")&&(e.preventDefault(),await S(e.target))})),document.addEventListener("click",(async function(e){var t,n;if(!(e.target instanceof Element))return;const r=null===(n=null===(t=e.target)||void 0===t?void 0:t.closest("[data-wfc-postback]"))||void 0===n?void 0:n.getAttribute("data-wfc-postback");if(!r)return;const i=_(e.target);e.preventDefault(),await S(i,r)})),document.addEventListener("keypress",(async function(e){if("Enter"!==e.key&&13!==e.keyCode&&13!==e.which)return;if(!(e.target instanceof Element)||"INPUT"!==e.target.tagName)return;const t=e.target.getAttribute("type");if("button"===t||"submit"===t||"reset"===t)return;const n=_(e.target),r=e.target.getAttribute("name");e.preventDefault(),await S(n,r,"ENTER")}));const k={};document.addEventListener("input",(function(e){var t;if(!(e.target instanceof Element&&"INPUT"===e.target.tagName&&e.target.hasAttribute("data-wfc-autopostback")))return;const n=e.target.getAttribute("type");if("button"===n||"submit"===n||"reset"===n)return;const r=_(e.target),i=e.target.getAttribute("name"),a=(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:"")+i;k[a]&&clearTimeout(k[a]),k[a]=setTimeout((async()=>{delete k[a],await S(r,i,"CHANGE")}),1e3)})),document.addEventListener("change",(async function(e){var t;if(e.target instanceof Element&&e.target.hasAttribute("data-wfc-autopostback")){const n=e.target.getAttribute("name"),r=_(e.target),i=(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:"")+n;k[i]&&clearTimeout(k[i]),setTimeout((()=>S(r,n,"CHANGE")),10)}}))}();
